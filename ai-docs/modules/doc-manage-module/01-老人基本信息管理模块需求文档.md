---
alwaysApply: false
---

# 老人基本信息管理模块需求文档

## 功能概述

### 功能描述
老人基本信息管理模块用于为每一位老人建立统一、结构化的基础档案，覆盖身份信息、联系方式、家庭住址、紧急联系人以及既往病史、药物过敏史等静态信息，为后续健康档案、健康评估和多角色协同提供基础数据支撑。

### 功能范围
- 老人基础档案创建（支持从注册用户快速生成基础档案）
- 老人基础档案查看与列表检索
- 老人基础档案编辑与信息补全
- 老人档案状态管理（在世、已故、已迁出等状态标记）
- 老人档案与平台账号（用户表）的关联管理

### 依赖关系
- 前置模块:
  - 系统与安全管理模块：提供用户注册、登录及权限控制能力
- 外部服务:
  - 暂无强制外部依赖，后续可扩展身份证校验等服务
- 数据依赖:
  - 用户数据表（users）：用于关联老人档案与平台登录账号
  - 老人基础信息表（elder_basic_info）：存储老人基础档案字段

## 功能需求

### 核心功能列表

| 功能编号 | 功能名称           |
|---------|--------------------|
| F001    | 老人基础档案创建   |
| F002    | 老人基础档案查看   |
| F003    | 老人档案检索与筛选 |
| F004    | 老人档案编辑与补全 |
| F005    | 老人档案状态管理   |

### 功能详细规格

#### F001: 老人基础档案创建
**功能描述**:  
系统为新加入平台的老人建立一份基础档案，确保至少包含可用于唯一识别及联系的核心信息，并与平台账号实现一对一或一对多的关联（视后续家庭账号共享策略而定）。

**关键逻辑思路**:
- 支持两类入口创建:
  - 用户注册为“老人”角色时，自动生成一份基础档案，最小字段集来自注册信息（如用户名/手机号、真实姓名）。
  - 管理端/医护端通过表单手工创建老人档案，用于录入线下已有老人信息。
- 创建时校验核心字段完整性（如姓名、联系方式至少一项、紧急联系人可选但建议给出）。
- 支持在创建时录入既往病史、药物过敏史等初始信息，也允许后续补录。
- 建立与用户账号的关联关系（若有），保证后续登录后可访问自己的档案。

**涉及的业务规则**:
- 老人姓名允许重名，但同一联系方式（手机号）不允许被多个“唯一主体”同时占用。
- 若通过“老人角色注册”创建档案，档案中“手机号”可默认使用注册时的手机号或用户名。
- 若未绑定用户账号，档案仍可存在，但无法在移动端以老人身份登录查看，仅供医护/管理员使用。

#### F002: 老人基础档案查看
**功能描述**:  
支持在管理端、医护端、老人端/家属端（权限控制后）查看单个老人的基础档案详情。

**关键逻辑思路**:
- 根据老人ID或关联用户ID，查询并展示基础档案信息。
- 展示信息包括：姓名、性别、出生日期、联系方式、家庭住址、紧急联系人、既往病史、药物过敏史、档案创建时间、最近更新时间等。
- 提供只读视图，用于老人和家属端；管理端/医护端可进入编辑模式。

**涉及的业务规则**:
- 老人或家属端只能查看与自己绑定的老人档案。
- 医护端可查看与其服务范围内老人（后续可结合协同模块做授权）。

#### F003: 老人档案检索与筛选
**功能描述**:  
在管理员或医护人员视角下，支持按条件查询老人列表，并快速定位目标老人的档案。

**关键逻辑思路**:
- 支持条件查询：姓名模糊搜索、手机号、身份证号、档案状态、创建时间区间等。
- 查询结果以分页列表形式展示，列表显示关键信息（姓名、年龄、联系方式、状态、最近更新时间）。
- 支持导出基础列表（后续可扩展）。

**涉及的业务规则**:
- 默认按创建时间或最近更新时间倒序排列，以方便找到最近新增或更新的档案。
- 对于已标记为“已删除/已迁出”等状态的档案，可以通过筛选项决定是否显示。

#### F004: 老人档案编辑与信息补全
**功能描述**:  
支持对既有老人档案进行信息修改和补全，保证基础信息的准确性和完整性。

**关键逻辑思路**:
- 支持编辑字段：姓名、性别、出生日期、联系方式、家庭住址、紧急联系人、既往病史、药物过敏史等。
- 对关键信息（如身份证号、手机号）进行格式校验。
- 编辑提交后，更新档案记录并记录更新时间（版本追踪细则在版本模块中定义）。

**涉及的业务规则**:
- 普通用户（老人本人或家属）仅可编辑有限字段，如联系方式、家庭住址等；涉及病史、过敏史等专业字段可限制为医护人员维护。
- 不允许直接修改与安全模块强相关的敏感标识（如内部主键ID）。

#### F005: 老人档案状态管理
**功能描述**:  
支持为老人档案设置状态，用于标记老人当前服务状态（在档、已迁出、已故等），便于在列表和后续统计中进行区分。

**关键逻辑思路**:
- 在档案详情中提供状态字段及修改入口（仅管理员/医护可操作）。
- 状态值示例：在档、已迁出、已故、暂停服务等。
- 当档案状态变化时，可触发相应提醒或联动（如“已故”状态后，不再发送健康提醒）。

**涉及的业务规则**:
- 状态变更应记录在档案历史版本或审计日志中（交由版本追踪模块具体定义）。
- 对于“已故”等不可逆状态，应提供确认流程（如二次确认弹窗）。

## 前端交互设计

### 交互流程（概要）
- 管理端/医护端：
  - 进入“老人档案管理”列表 → 条件搜索 → 查看档案详情 → 编辑/状态变更。
- 老人端：
  - 登录后进入“我的档案” → 查看基础信息 → 可编辑部分可在本端修改并提交。
- 家属端：
  - 进入“家庭老人列表” → 选择某位老人 → 查看基础档案 → 按权限编辑部分字段。

## 数据模型

### 数据库设计
当前数据库已提供 `elder_basic_info` 表，用于保存老人基础信息。本模块在后端实现时应优先复用该表结构，如需扩展字段，应与整体健康档案设计统一规划。

#### 表结构设计（示例，不强制与现有结构一一对应）

##### elder_basic_info
| 字段名            | 数据类型  | 长度 | 约束             | 默认值           | 说明                 |
|-------------------|-----------|------|------------------|------------------|----------------------|
| id                | BIGINT    | -    | PK, AUTO_INCREMENT | -              | 主键ID               |
| name              | VARCHAR   | 50   | NOT NULL         | -                | 姓名                 |
| gender            | TINYINT   | -    | NOT NULL         | 1                | 性别(0女,1男)        |
| birth_date        | DATE      | -    | NOT NULL         | -                | 出生日期             |
| phone             | VARCHAR   | 20   | NULL             | NULL             | 联系电话             |
| address           | VARCHAR   | 255  | NULL             | NULL             | 家庭住址             |
| id_card           | VARCHAR   | 32   | NULL             | NULL             | 身份证号             |
| emergency_contact | VARCHAR   | 100  | NULL             | NULL             | 紧急联系人信息       |
| medical_history   | TEXT      | -    | NULL             | NULL             | 既往病史             |
| allergy_history   | TEXT      | -    | NULL             | NULL             | 药物过敏史           |
| created_at        | DATETIME  | -    | NOT NULL         | CURRENT_TIMESTAMP | 创建时间            |
| updated_at        | DATETIME  | -    | NOT NULL         | CURRENT_TIMESTAMP | 更新时间            |

**索引设计**:
- PRIMARY KEY (id)
- INDEX idx_elder_phone (phone)
- INDEX idx_elder_name (name)

## 接口设计

### API 概览

#### 主要API列表

| 接口路径                                   | 方法   | 处理问题                                   | 权限要求                   |
|--------------------------------------------|--------|--------------------------------------------|----------------------------|
| GET /api/v1/elder-health/elder/list       | GET    | 分页查询老人基础档案列表，支持按姓名、身份证号筛选 | 管理/医护                  |
| GET /api/v1/elder-health/elder/{id}       | GET    | 查看指定老人基础档案                       | 管理/医护/本人/家属        |
| POST /api/v1/elder-health/elder           | POST   | 创建老人基础档案                           | 管理/医护                  |
| PUT /api/v1/elder-health/elder/{id}       | PUT    | 更新老人基础档案                           | 管理/医护（部分字段可老人/家属） |
| DELETE /api/v1/elder-health/elder/{id}    | DELETE | 删除老人基础档案                           | 管理/医护                  |

后续具体请求参数、响应格式、错误码等细节可在 Swagger 文档中进一步细化。

## 架构设计
本模块将作为“老人档案管理模块”的基础子模块，与健康档案管理、版本追踪模块共享老人ID主键。前端通过统一的 ElderProfileService 访问后端 API，后端通过服务层和数据访问层实现业务逻辑与持久化分离。

## 关键技术点
1. 基础字段校验与数据清洗（如手机号、身份证号合法性校验）。
2. 与用户体系、角色体系的关联（确保只有有权限的角色可访问对应档案）。
3. 与后续版本追踪模块的扩展兼容（变更操作具备可追踪性）。

## 性能优化策略
- 对高频查询字段（如姓名、手机号）建立索引以提升检索效率。
- 列表接口采用分页查询，避免一次性返回过多记录。

---

